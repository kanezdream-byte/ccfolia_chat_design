* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: #f0f2f5;
    margin: 0;
    padding: 0;
    color: #2c3e50;
    overflow-x: hidden;
    min-width: 1200px;
}

.container {
    position: relative;
    height: 100vh;
    padding: 10px;
    padding-top: 74px; /* 헤더 공간 확보 */
}

.header {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: none;
    border-bottom: 1px solid rgba(228, 230, 235, 0.3);
    padding: 16px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    height: 64px;
    box-sizing: border-box;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.header-left {
    display: flex;
    align-items: center;
    gap: 32px;
    position: relative;
    z-index: 1;
}

.app-title {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.app-title h1 {
    font-size: 24px;
    font-weight: 800;
    margin: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.5px;
    line-height: 1;
}

.app-subtitle {
    font-size: 11px;
    color: #8b9dc3;
    font-weight: 500;
    opacity: 0.8;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    pointer-events: none;
}


.header-actions {
    display: flex;
    gap: 10px;
    align-items: center;
    position: relative;
    z-index: 1;
}

.header-action-btn {
    background: rgba(66, 103, 178, 0.9);
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    white-space: nowrap;
    min-height: 38px;
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(66, 103, 178, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    line-height: 1;
    min-width: 80px;
}

.btn-icon {
    font-size: 12px;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
}

.header-action-btn:hover {
    background: rgba(54, 88, 153, 0.95);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(66, 103, 178, 0.3);
}

/* 네비게이션 탭 스타일 */
.nav-tabs {
    display: flex;
    gap: 8px;
}

.nav-tab {
    padding: 8px 16px;
    background: transparent;
    color: #8b9dc3;
    text-decoration: none;
    border-radius: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    font-size: 14px;
    font-weight: 500;
}

.nav-tab:hover {
    background: rgba(102, 126, 234, 0.1);
    color: #667eea;
    transform: translateY(-1px);
}

.nav-tab.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
}

.tab-icon {
    font-size: 16px;
}

.header-action-btn.secondary {
    background: rgba(228, 230, 235, 0.9);
    color: #050505;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
    min-height: 38px;
    min-width: 80px;
}

.header-action-btn.secondary:hover {
    background: rgba(208, 210, 215, 0.95);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.main-layout {
    display: grid;
    grid-template-columns: 300px 1fr 280px;
    gap: 10px;
    height: calc(100vh - 84px);
    position: relative;
}

.controls-panel {
    background: white;
    border-radius: 12px;
    padding: 14px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid #e4e6eb;
    height: 100%;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 14px;
}

.control-section {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 14px;
    border: none;
    flex-shrink: 0;
    transition: all 0.2s ease;
}

.control-section:hover {
    background: #f1f3f4;
    transform: translateY(-1px);
}

.section-title {
    font-size: 11px;
    font-weight: 700;
    color: #4267b2;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-title::before {
    content: '';
    width: 3px;
    height: 16px;
    background: linear-gradient(135deg, #4267b2, #365899);
    border-radius: 2px;
}

label {
    display: block;
    margin-bottom: 6px;
    font-size: 12px;
    font-weight: 500;
    color: #1c1e21;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

select, input[type="number"] {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #dddfe2;
    border-radius: 8px;
    font-size: 12px;
    white-space: nowrap;
    background: white;
    color: #1c1e21;
    transition: all 0.2s ease;
    margin-bottom: 10px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    text-overflow: ellipsis;
}

input[type="color"] {
    width: 100%;
    height: 36px;
    padding: 4px;
    border: 1px solid #dddfe2;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    margin-bottom: 12px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    transition: all 0.2s ease;
}

input[type="checkbox"] {
    margin-right: 10px;
    transform: scale(1.3);
    accent-color: #4267b2;
}

label:has(input[type="checkbox"]) {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
    cursor: pointer;
    padding: 6px;
    font-size: 12px;
    white-space: nowrap;
    border-radius: 6px;
    transition: background 0.2s ease;
}

label:has(input[type="checkbox"]):hover {
    background: rgba(66, 103, 178, 0.05);
}

select:hover, input[type="number"]:hover, input[type="color"]:hover {
    border-color: #4267b2;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

select:focus, input[type="number"]:focus, input[type="color"]:focus {
    outline: none;
    border-color: #4267b2;
    box-shadow: 0 0 0 3px rgba(66, 103, 178, 0.15);
}

button {
    width: 100%;
    padding: 12px 16px;
    border: none;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    position: relative;
    overflow: hidden;
}

.btn-primary {
    background: linear-gradient(135deg, #4267b2 0%, #365899 100%);
    color: white;
    border: 1px solid #365899;
}

.btn-primary:hover {
    background: linear-gradient(135deg, #365899 0%, #2d4373 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(66, 103, 178, 0.3);
}

.btn-secondary {
    background: rgba(228, 230, 235, 0.9);
    color: #1c1e21;
    border: 1px solid #dddfe2;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    white-space: nowrap;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    min-height: 32px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.btn-secondary:hover {
    background: rgba(208, 210, 215, 0.95);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.file-controls {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
}

.file-input-wrapper {
    flex: 1;
    position: relative;
}

.file-input-wrapper input[type="file"] {
    position: absolute;
    left: -9999px;
    opacity: 0;
}

.file-controls .btn-secondary {
    flex: 1;
}

button:active {
    transform: translateY(0);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.preview-container {
    background: white;
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    border: 2px solid #4267b2;
    overflow: hidden;
    height: 100%;
    display: flex;
    flex-direction: column;
    position: relative; /* 레이아웃 안정성을 위해 추가 */
}

.preview-container.aspect-mode {
    height: auto;
    align-self: flex-start;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
}

.preview-container.aspect-mode .preview-header {
    width: 100%;
}

.preview-container.aspect-mode .chat-container {
    width: auto;
}

.preview-header {
    background: linear-gradient(135deg, #4267b2 0%, #365899 100%);
    color: white;
    padding: 12px 16px;
    font-size: 13px;
    font-weight: 600;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

.preview-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.preview-badge {
    background: rgba(255, 255, 255, 0.2);
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 11px;
}

.header-controls {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
}

.pagination-controls {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.header-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 10px;
    font-weight: 600;
    transition: all 0.2s;
    white-space: nowrap;
    flex-shrink: 0;
}

.header-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.pagination-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    transition: all 0.2s;
    flex-shrink: 0;
}

.pagination-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.pagination-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.page-info {
    font-size: 11px;
    background: rgba(255, 255, 255, 0.15);
    padding: 4px 8px;
    border-radius: 8px;
    min-width: 50px;
    text-align: center;
    white-space: nowrap;
    flex-shrink: 0;
}

.chat-container {
    background: #ffffff;
    padding: 16px;
    overflow-y: auto;
    flex: 1;
    transition: all 0.3s;
}

/* Aspect Ratios */
.chat-container.aspect-square { 
    aspect-ratio: 1 / 1; 
    flex: none !important;
    height: auto;
    width: 100%;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    position: relative;
}
.chat-container.aspect-9-16 { 
    aspect-ratio: 9 / 16; 
    flex: none !important;
    height: auto;
    width: 100%;
    max-width: 400px;
    overflow-y: auto;
    position: relative;
}
.chat-container.aspect-4-5 { 
    aspect-ratio: 4 / 5; 
    flex: none !important;
    height: auto;
    width: 100%;
    max-width: 450px;
    overflow-y: auto;
    position: relative;
}
.chat-container.aspect-full { 
    /* Use full available height */
}

/* Custom scrollbar styling for aspect ratio containers */
.chat-container.aspect-square::-webkit-scrollbar,
.chat-container.aspect-9-16::-webkit-scrollbar,
.chat-container.aspect-4-5::-webkit-scrollbar {
    width: 8px;
}

.chat-container.aspect-square::-webkit-scrollbar-track,
.chat-container.aspect-9-16::-webkit-scrollbar-track,
.chat-container.aspect-4-5::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 4px;
}

.chat-container.aspect-square::-webkit-scrollbar-thumb,
.chat-container.aspect-9-16::-webkit-scrollbar-thumb,
.chat-container.aspect-4-5::-webkit-scrollbar-thumb {
    background: rgba(66, 103, 178, 0.6);
    border-radius: 4px;
}

.chat-container.aspect-square::-webkit-scrollbar-thumb:hover,
.chat-container.aspect-9-16::-webkit-scrollbar-thumb:hover,
.chat-container.aspect-4-5::-webkit-scrollbar-thumb:hover {
    background: rgba(66, 103, 178, 0.8);
}

/* Add some padding at the bottom for better scrolling experience */
.chat-container.aspect-square .message:last-child,
.chat-container.aspect-9-16 .message:last-child,
.chat-container.aspect-4-5 .message:last-child,
.chat-container.aspect-square .system-message:last-child,
.chat-container.aspect-9-16 .system-message:last-child,
.chat-container.aspect-4-5 .system-message:last-child {
    margin-bottom: 16px;
}

/* Solid Color Block */
.solid-color-block {
    background: rgba(240, 242, 245, 0.8);
    border-radius: 6px;
    margin: 6px 0;
    padding: 12px;
    position: relative;
    border: 1px solid rgba(0, 0, 0, 0.1);
}

.solid-color-block .block-controls {
    position: absolute;
    top: 8px;
    right: 8px;
    display: none;
    gap: 4px;
}

.solid-color-block:hover .block-controls {
    display: flex;
}

.block-control-btn {
    width: 24px;
    height: 24px;
    border-radius: 4px;
    border: 1px solid #dddfe2;
    background: white;
    color: #65676b;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    transition: all 0.2s;
    padding: 0;
}

.block-control-btn:hover {
    background: #f0f2f5;
    color: #1c1e21;
}

.block-control-btn.delete:hover {
    background: #ffebee;
    color: #c62828;
    border-color: #ffcdd2;
}

.block-control-btn.settings:hover {
    background: #e3f2fd;
    color: #1976d2;
    border-color: #bbdefb;
}

.theme-cocofolia {
    background: #272729;
}

.theme-cocofolia .message {
    display: flex;
    padding: 12px 16px;
    border-radius: 0;
    margin-bottom: 8px;
    background: #36393f;
    border: none;
    border-left: 4px solid #7289da;
    transition: all 0.2s;
}

.theme-cocofolia .message:hover {
    background: #32353b;
    border-left-color: #677bc4;
}

.theme-cocofolia .avatar {
    width: 32px;
    height: 32px;
    border-radius: 4px;
    margin-right: 12px;
    background: linear-gradient(135deg, #7289da 0%, #5b6eae 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 14px;
    overflow: hidden;
    flex-shrink: 0;
}

.theme-cocofolia .message-content {
    flex: 1;
}

.theme-cocofolia .character-name {
    font-weight: 600;
    margin-bottom: 4px;
    font-size: 13px;
    color: #ffffff;
}

.theme-cocofolia .message-text {
    color: #dcddde;
    line-height: 1.5;
    font-size: 12px;
}

.theme-cocofolia .timestamp {
    color: #72767d;
    font-size: 10px;
    margin-top: 2px;
}

.theme-cocofolia .solid-color-block {
    background: #2f3136;
    border-radius: 0;
    border-left: 4px solid #faa61a;
    border-top: none;
    border-right: none;
    border-bottom: none;
    padding: 12px 16px;
}

/* Discord Style */
.theme-discord {
    background: #313338;
    color: #dbdee1;
}

.theme-discord .message {
    display: flex;
    padding: 6px 12px;
    margin: 1px 0;
    border-radius: 4px;
    transition: background 0.1s;
}

.theme-discord .message:hover {
    background: rgba(255, 255, 255, 0.02);
}

.theme-discord .avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    margin-right: 12px;
    background: #5865f2;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 14px;
    overflow: hidden;
    flex-shrink: 0;
}

.theme-discord .character-name {
    font-weight: 500;
    margin-bottom: 1px;
    display: inline-block;
    font-size: 13px;
}

.theme-discord .timestamp {
    display: inline-block;
    margin-left: 6px;
    color: #949ba4;
    font-size: 10px;
    font-weight: 400;
}

.theme-discord .message-text {
    color: #dbdee1;
    line-height: 1.3;
    margin-top: 1px;
    font-size: 12px;
}

/* Twitter Style */
.theme-twitter {
    background: #ffffff;
}

.theme-twitter .message {
    padding: 12px;
    border-bottom: 1px solid #eff3f4;
    transition: background 0.2s;
}

.theme-twitter .message:hover {
    background: #f7f9fa;
}

.theme-twitter .avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    margin-right: 10px;
    background: #1d9bf0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 16px;
    float: left;
    overflow: hidden;
    flex-shrink: 0;
}

.theme-twitter .message-header {
    display: flex;
    align-items: center;
    margin-bottom: 3px;
}

.theme-twitter .character-name {
    font-weight: 700;
    color: #0f1419;
    margin-right: 4px;
    font-size: 13px;
}

.theme-twitter .timestamp {
    color: #536471;
    font-size: 11px;
}

.theme-twitter .message-text {
    color: #0f1419;
    line-height: 1.4;
    margin-left: 46px;
    font-size: 12px;
}

/* System Messages */
.theme-cocofolia .system-message {
    background: #f0f2f5;
    border-left: 3px solid #8b9dc3;
    padding: 8px 12px;
    margin: 6px 0;
    border-radius: 4px;
    color: #65676b;
    font-size: 11px;
    font-style: italic;
}

.theme-discord .system-message {
    background: rgba(88, 101, 242, 0.08);
    border-left: 3px solid #5865f2;
    padding: 6px 12px;
    margin: 4px 0;
    color: #949ba4;
    font-size: 11px;
    font-style: italic;
}

.theme-twitter .system-message {
    background: #f7f9fa;
    border-left: 3px solid #1d9bf0;
    padding: 8px 12px;
    margin: 6px 0;
    color: #536471;
    font-size: 11px;
    font-style: italic;
}

.file-input-wrapper {
    position: relative;
    overflow: hidden;
    width: 100%;
}

.file-input-wrapper input[type=file] {
    position: absolute;
    left: -9999px;
}

.file-input-label {
    display: block;
    width: 100%;
    padding: 12px 16px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    color: #495057;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    text-align: center;
    transition: all 0.2s ease;
    font-size: 13px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.file-input-label:hover {
    background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.file-status {
    margin-top: 8px;
    padding: 8px 12px;
    background: #e3f2fd;
    border: 1px solid #90caf9;
    border-radius: 6px;
    font-size: 13px;
    color: #1976d2;
    display: none;
}

.file-status.active {
    display: block;
}

.stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
    margin-top: 8px;
}

.stat-item {
    background: #f0f2f5;
    padding: 6px 8px;
    border-radius: 4px;
    font-size: 11px;
}

.stat-label {
    color: #65676b;
    margin-bottom: 2px;
}

.stat-value {
    color: #1c1e21;
    font-weight: 600;
    font-size: 12px;
}

.name-change-item {
    display: flex;
    gap: 8px;
    margin-bottom: 8px;
    align-items: center;
}

.name-change-item input {
    flex: 1;
    padding: 8px 10px;
    border: 1px solid #dddfe2;
    border-radius: 6px;
    font-size: 13px;
}

.original-name {
    flex: 1;
    padding: 8px 10px;
    background: #f0f2f5;
    border-radius: 6px;
    font-size: 13px;
    color: #65676b;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.editable-text {
    cursor: text;
    transition: background 0.2s;
    padding: 2px 4px;
    border-radius: 4px;
}

.editable-text:hover {
    background: rgba(66, 103, 178, 0.1);
}

.editable-text:focus {
    outline: 2px solid #4267b2;
    background: white;
}

.message-controls {
    position: absolute;
    top: 8px;
    right: 8px;
    display: none;
    gap: 4px;
}

.message:hover .message-controls,
.system-message:hover .message-controls {
    display: flex;
}

.message-control-btn {
    width: 28px;
    height: 28px;
    border-radius: 6px;
    border: 1px solid #dddfe2;
    background: white;
    color: #65676b;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    transition: all 0.2s;
    padding: 0;
}

.message-control-btn:hover {
    background: #f0f2f5;
    color: #1c1e21;
}

.message-control-btn.delete:hover {
    background: #ffebee;
    color: #c62828;
    border-color: #ffcdd2;
}

.message-control-btn.duplicate:hover {
    background: #e8f5e9;
    color: #2e7d32;
    border-color: #c8e6c9;
}

.message-control-btn.add:hover {
    background: #e3f2fd;
    color: #1976d2;
    border-color: #bbdefb;
}

.message-control-btn.move-up:hover {
    background: #f3e5f5;
    color: #7b1fa2;
    border-color: #ce93d8;
}

.message-control-btn.move-down:hover {
    background: #f3e5f5;
    color: #7b1fa2;
    border-color: #ce93d8;
}

.message {
    position: relative;
}

.system-message {
    position: relative;
}

.add-message-panel {
    background: #e3f2fd;
    border: 2px dashed #90caf9;
    border-radius: 8px;
    padding: 16px;
    margin: 12px 0;
    display: none;
}

.add-message-panel.active {
    display: block;
}

.add-message-controls {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
}

.add-message-type {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #90caf9;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    font-size: 13px;
}

.add-message-type:hover {
    background: #f3f4f6;
}

.add-message-type.selected {
    background: #1976d2;
    color: white;
    border-color: #1976d2;
}

.add-message-form {
    display: grid;
    gap: 8px;
}

.add-message-form input,
.add-message-form textarea {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #dddfe2;
    border-radius: 6px;
    font-size: 13px;
}

.add-message-form textarea {
    min-height: 60px;
    resize: vertical;
}

.add-message-actions {
    display: flex;
    gap: 8px;
    margin-top: 8px;
}

.add-message-actions button {
    flex: 1;
    padding: 8px 12px;
    font-size: 13px;
}

.edit-mode-notice {
    background: #e3f2fd;
    border: 1px solid #90caf9;
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 12px;
    font-size: 13px;
    color: #1976d2;
    display: none;
}

.edit-mode-notice.active {
    display: block;
}

/* Text Formatting Styles */
.text-bold { font-weight: bold; }
.text-italic { font-style: italic; }
.text-mosaic {
    background: linear-gradient(45deg, #000 25%, #fff 25%, #fff 50%, #000 50%, #000 75%, #fff 75%);
    background-size: 8px 8px;
    color: transparent;
    -webkit-background-clip: text;
    background-clip: text;
    filter: blur(2px);
}
.text-blind {
    background: #000;
    color: #000;
    border-radius: 3px;
    transition: all 0.3s;
}
.text-blind:hover {
    background: transparent;
    color: inherit;
}
.text-center {
    text-align: center;
}

/* Font Size Classes */
.font-small .message-text { font-size: 10px; }
.font-small .character-name { font-size: 11px; }
.font-small .timestamp { font-size: 8px; }
.font-small .system-message { font-size: 9px; }

.font-medium .message-text { font-size: 12px; }
.font-medium .character-name { font-size: 13px; }
.font-medium .timestamp { font-size: 10px; }
.font-medium .system-message { font-size: 11px; }

.font-large .message-text { font-size: 14px; }
.font-large .character-name { font-size: 15px; }
.font-large .timestamp { font-size: 12px; }
.font-large .system-message { font-size: 13px; }

.font-extra-large .message-text { font-size: 16px; }
.font-extra-large .character-name { font-size: 17px; }
.font-extra-large .timestamp { font-size: 14px; }
.font-extra-large .system-message { font-size: 15px; }

/* Avatar Size Classes - 원형 아바타 크기 조절 시스템 */

/* 작은 아바타 (28px) - 컴팩트한 디자인용 */
.avatar-small .avatar {
    width: 28px;
    height: 28px;
    border-radius: 50%;  /* 완전한 원형 */
    margin-right: 10px;   /* 메시지와의 간격 */
    background: linear-gradient(135deg, #7289da 0%, #5b6eae 100%);
    display: flex;
    align-items: center;      /* 수직 중앙 정렬 */
    justify-content: center;  /* 수평 중앙 정렬 */
    color: white;
    font-weight: 600;
    font-size: 10px;  /* 작은 아바타에 맞는 폰트 크기 */
    overflow: hidden;
    flex-shrink: 0;   /* 크기 고정 */
}

/* 보통 아바타 (36px) - 기본 크기 */
.avatar-medium .avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    margin-right: 12px;
    background: linear-gradient(135deg, #7289da 0%, #5b6eae 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 14px;  /* 표준 폰트 크기 */
    overflow: hidden;
    flex-shrink: 0;
}

/* 큰 아바타 (44px) - 강조용 */
.avatar-large .avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    margin-right: 14px;
    background: linear-gradient(135deg, #7289da 0%, #5b6eae 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 16px;  /* 큰 아바타에 맞는 폰트 크기 */
    overflow: hidden;
    flex-shrink: 0;
}

/* 매우 큰 아바타 (52px) - 프레젠테이션용 */
.avatar-extra-large .avatar {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    margin-right: 16px;
    background: linear-gradient(135deg, #7289da 0%, #5b6eae 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 18px;  /* 매우 큰 아바타에 맞는 폰트 크기 */
    overflow: hidden;
    flex-shrink: 0;
}

/* Timestamp Display Control - 타임스탬프 표시/숨김 제어 */
.hide-timestamp .timestamp {
    display: none !important;  /* 타임스탬프 완전히 숨김 */
}

/* 타임스탬프 숨김 시 메시지 여백 조정 */
.hide-timestamp .character-name {
    margin-bottom: 0;  /* 캐릭터명 하단 여백 제거 */
}

/* Auto-fit content mode - 헤더 위치를 방해하지 않도록 개선 */
.chat-container.auto-fit-content {
    aspect-ratio: unset !important;
    height: auto !important;
    width: 100%;
    max-width: none;
    max-height: none;
    overflow-y: visible !important;
    position: relative;
}

/* auto-fit 모드에서도 preview-container의 기본 구조 유지 */
.preview-container.auto-fit-mode {
    /* height와 overflow를 제거하여 레이아웃 안정성 확보 */
}

.preview-container.auto-fit-mode .chat-container {
    padding-bottom: 20px; /* 하단 여백 확보 */
}

/* Custom width for auto-fit mode */
.chat-container.auto-fit-content.custom-width {
    max-width: var(--custom-width);
    margin: 0 auto; /* 중앙 정렬 */
}

.preview-container.auto-fit-mode.custom-width {
    display: flex;
    justify-content: center; /* 컨테이너 중앙 정렬 */
}

/* Formatting Toolbar */
.format-toolbar {
    position: fixed;
    background: white;
    border: 2px solid #4267b2;
    border-radius: 8px;
    padding: 8px;
    display: none;
    gap: 4px;
    z-index: 1000;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.format-toolbar.active {
    display: flex;
}

.format-btn {
    width: 32px;
    height: 32px;
    border: 1px solid #dddfe2;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: bold;
    transition: all 0.2s;
}

.format-btn:hover {
    background: #f0f2f5;
    border-color: #8b9dc3;
}

.format-btn.active {
    background: #4267b2;
    color: white;
    border-color: #4267b2;
}

.color-picker {
    width: 32px;
    height: 32px;
    border: 1px solid #dddfe2;
    border-radius: 6px;
    cursor: pointer;
    overflow: hidden;
}

.color-picker input[type="color"] {
    width: 100%;
    height: 100%;
    border: none;
    cursor: pointer;
}

/* Text Selection Highlight */
.selected-text {
    background: rgba(66, 103, 178, 0.2);
    border-radius: 2px;
}

@media (max-width: 1200px) {
    .main-layout {
        grid-template-columns: 280px 1fr 260px;
    }
}

/* Avatar click interaction */
.avatar {
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    position: relative;
}

.avatar:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.avatar.clickable::after {
    content: '✏️';
    position: absolute;
    bottom: -2px;
    right: -2px;
    background: white;
    border-radius: 50%;
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transition: opacity 0.2s ease;
}

.avatar.clickable:hover::after {
    opacity: 1;
}

/* Avatar Modal Styles */
.avatar-modal {
    display: none;
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
}

.avatar-modal.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.avatar-modal-content {
    background: white;
    border-radius: 12px;
    width: 90%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.avatar-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid #e0e0e0;
}

.avatar-modal-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: #333;
}

.avatar-modal-close {
    background: none;
    border: none;
    font-size: 24px;
    color: #666;
    cursor: pointer;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.avatar-modal-close:hover {
    background-color: #f0f0f0;
}

.avatar-modal-body {
    padding: 24px;
}

.avatar-character-info {
    text-align: center;
    margin-bottom: 20px;
}

.current-character-name {
    font-size: 16px;
    font-weight: 600;
    color: #4267b2;
    background: #f0f2f5;
    padding: 8px 16px;
    border-radius: 20px;
    display: inline-block;
}

.avatar-option-tabs {
    display: flex;
    border-bottom: 1px solid #e0e0e0;
    margin-bottom: 24px;
}

.avatar-tab {
    flex: 1;
    background: none;
    border: none;
    padding: 12px 16px;
    font-size: 14px;
    font-weight: 500;
    color: #666;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.2s ease;
}

.avatar-tab:hover {
    color: #4267b2;
    background-color: #f8f9fa;
}

.avatar-tab.active {
    color: #4267b2;
    border-bottom-color: #4267b2;
    background-color: #f8f9fa;
}

.avatar-tab-content {
    display: none;
}

.avatar-tab-content.active {
    display: block;
}

.avatar-upload-area {
    margin-bottom: 16px;
}

.avatar-upload-label {
    display: block;
    border: 2px dashed #ccc;
    border-radius: 8px;
    padding: 40px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
}

.avatar-upload-label:hover {
    border-color: #4267b2;
    background-color: #f8f9fa;
}

.upload-icon {
    font-size: 32px;
    margin-bottom: 8px;
}

.upload-text {
    font-size: 16px;
    font-weight: 500;
    color: #333;
    margin-bottom: 4px;
}

.upload-hint {
    font-size: 12px;
    color: #666;
}

.avatar-url-input {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
}

.avatar-url-input input {
    flex: 1;
    padding: 10px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
}

.avatar-url-input button {
    padding: 10px 16px;
    background: #4267b2;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.avatar-url-input button:hover {
    background: #365899;
}

.avatar-color-picker {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}

.avatar-color-picker label {
    font-size: 14px;
    font-weight: 500;
    color: #333;
}

.avatar-color-picker input[type="color"] {
    width: 40px;
    height: 40px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}

.avatar-preview {
    text-align: center;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
}

.avatar-preview img {
    max-width: 100px;
    max-height: 100px;
    border-radius: 50%;
    object-fit: cover;
}

.avatar-color-sample {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    margin: 0 auto;
    border: 3px solid white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.avatar-modal-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 24px;
    border-top: 1px solid #e0e0e0;
    background: #f8f9fa;
}

.avatar-modal-actions {
    display: flex;
    gap: 8px;
}

.btn-primary {
    background: #4267b2;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.btn-primary:hover {
    background: #365899;
}

@media (max-width: 768px) {
    .avatar-modal-content {
        width: 95%;
        margin: 10px;
    }
    
    .avatar-modal-header,
    .avatar-modal-body,
    .avatar-modal-footer {
        padding: 16px;
    }
    
    .avatar-modal-footer {
        flex-direction: column;
        gap: 12px;
    }
    
    .avatar-modal-actions {
        width: 100%;
        justify-content: stretch;
    }
    
    .avatar-modal-actions button {
        flex: 1;
    }
}

/* Fixed Sidebar Styles */
.name-sidebar-fixed {
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid #e4e6eb;
    height: 100%;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
}


.name-sidebar-fixed .sidebar-header {
    padding: 16px 20px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
    background: linear-gradient(135deg, #4267b2 0%, #365899 100%);
    color: white;
    border-radius: 12px 12px 0 0;
    min-height: 64px;
}

.sidebar-icon {
    font-size: 20px;
    flex-shrink: 0;
}

.name-sidebar-fixed .sidebar-header h3 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    white-space: nowrap;
    flex: 1;
}

.character-count-badge {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    font-size: 12px;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 10px;
    min-width: 18px;
    text-align: center;
}


.sidebar-close-btn {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.sidebar-close-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.name-sidebar-fixed .sidebar-content {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.sidebar-info {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 14px;
    border: none;
    flex-shrink: 0;
    transition: all 0.2s ease;
    margin-bottom: 16px;
}

.sidebar-info:hover {
    background: #f1f3f4;
    transform: translateY(-1px);
}

.sidebar-info p {
    margin: 0;
    color: #666;
    font-size: 14px;
    line-height: 1.5;
}

.name-change-section {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 14px;
    border: none;
    flex: 1;
    transition: all 0.2s ease;
    margin-bottom: 16px;
    display: flex;
    flex-direction: column;
}

.name-change-section:hover {
    background: #f1f3f4;
    transform: translateY(-1px);
}

.name-change-container {
    flex: 1;
    min-height: 100px;
}

.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 32px 16px;
    text-align: center;
    min-height: 150px;
}

.empty-icon {
    font-size: 48px;
    margin-bottom: 12px;
    opacity: 0.5;
}

.empty-text {
    font-size: 16px;
    font-weight: 500;
    color: #65676b;
    margin-bottom: 4px;
}

.empty-subtext {
    font-size: 12px;
    color: #8b9dc3;
    line-height: 1.4;
}

.name-change-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px;
    border-radius: 8px;
    background: white;
    border: 1px solid #e4e6eb;
    margin-bottom: 8px;
    transition: all 0.2s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.name-change-item:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border-color: #4267b2;
}

.name-change-item:last-child {
    margin-bottom: 0;
}

.original-name {
    background: rgba(66, 103, 178, 0.1);
    color: #4267b2;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    min-width: 70px;
    text-align: center;
    border: 1px solid rgba(66, 103, 178, 0.2);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 80px;
}

.name-change-item > span {
    color: #666;
    font-weight: 500;
}

.name-change-item input {
    flex: 1;
    padding: 6px 10px;
    border: 1px solid #dddfe2;
    border-radius: 6px;
    font-size: 12px;
    background: #fafafa;
    transition: all 0.2s ease;
    min-width: 0;
}

.name-change-item input:focus {
    outline: none;
    border-color: #4267b2;
    box-shadow: 0 0 0 2px rgba(66, 103, 178, 0.1);
    background: white;
}

.name-change-item input:not(:placeholder-shown) {
    background: #e8f5e9;
    border-color: #4caf50;
}

.sidebar-actions {
    border-top: 1px solid #e0e0e0;
    padding-top: 16px;
}

/* Color Block Panel Styles */
.color-block-panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    z-index: 10001;
    min-width: 300px;
    animation: modalSlideIn 0.3s ease-out;
}

.panel-header {
    padding: 16px 20px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, #4267b2 0%, #365899 100%);
    color: white;
    border-radius: 12px 12px 0 0;
}

.panel-header h4 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
}

.panel-close-btn {
    background: none;
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.panel-close-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.panel-content {
    padding: 20px;
}

.panel-control {
    margin-bottom: 16px;
}

.panel-control:last-of-type {
    margin-bottom: 20px;
}

.panel-control label {
    display: block;
    margin-bottom: 8px;
    font-size: 14px;
    font-weight: 500;
    color: #333;
}

.panel-control input[type="color"] {
    width: 60px;
    height: 40px;
    border: 1px solid #ccc;
    border-radius: 6px;
    cursor: pointer;
}

.panel-control input[type="range"] {
    width: 200px;
    margin-right: 12px;
}

.panel-control #opacityValue {
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

.panel-actions {
    display: flex;
    gap: 8px;
    border-top: 1px solid #e0e0e0;
    padding-top: 16px;
}

.panel-btn {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background: white;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s ease;
}

.panel-btn:hover {
    background: #f8f9fa;
}

.panel-btn.danger {
    background: #dc3545;
    border-color: #dc3545;
    color: white;
}

.panel-btn.danger:hover {
    background: #c82333;
    border-color: #c82333;
}

/* Color Block Selection Styles */
.solid-color-block {
    position: relative;
    cursor: pointer;
    transition: all 0.2s ease;
}

.solid-color-block:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.solid-color-block.selected {
    outline: 3px solid #4267b2;
    outline-offset: 2px;
}

.solid-color-block.selected::after {
    content: '✓';
    position: absolute;
    top: 8px;
    right: 8px;
    background: #4267b2;
    color: white;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    z-index: 10;
}

/* Responsive Design */
@media (max-width: 768px) {
    .name-sidebar {
        width: 100%;
        right: -100%;
    }
    
    .sidebar-header {
        padding: 20px 16px 16px 16px;
    }
    
    .sidebar-content {
        padding: 16px;
    }
    
    .color-block-panel {
        width: 90%;
        min-width: auto;
    }
    
    .panel-control input[type="range"] {
        width: 150px;
    }
    
    .panel-actions {
        flex-direction: column;
    }
    
    .panel-btn {
        flex: none;
    }
}